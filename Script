-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

-- Create the ScreenGui
local gui = Instance.new("ScreenGui")
gui.Name = "CashewGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Main container frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 350, 0, 450)
mainFrame.Position = UDim2.new(0.5, -175, 0.5, -225)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = gui

-- UIStroke for border styling
local uiStroke = Instance.new("UIStroke")
uiStroke.Thickness = 1.5
uiStroke.Color = Color3.fromRGB(70, 70, 70)
uiStroke.Parent = mainFrame

-- Tabs container on left side
local tabsContainer = Instance.new("Frame")
tabsContainer.Size = UDim2.new(0, 90, 0, 450)
tabsContainer.Position = UDim2.new(0, 0, 0, 0)
tabsContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
tabsContainer.Parent = mainFrame

-- Tab buttons
local tabNames = {"Player", "Main", "Settings"}
local tabButtons = {}

for i, name in ipairs(tabNames) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 50)
    btn.Position = UDim2.new(0, 0, 0, (i-1)*50)
    btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    btn.Text = name
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 18
    btn.Parent = tabsContainer
    tabButtons[name] = btn
end

-- Content container frame (right side)
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -90, 1, 0)
contentFrame.Position = UDim2.new(0, 90, 0, 0)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = mainFrame

-- ScrollingFrame for all tab content
local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Size = UDim2.new(1, 0, 1, 0)
scrollFrame.CanvasSize = UDim2.new(0, 0, 2, 0)  -- allows vertical scroll
scrollFrame.ScrollBarThickness = 6
scrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
scrollFrame.BackgroundTransparency = 1
scrollFrame.Parent = contentFrame

local uiListLayout = Instance.new("UIListLayout")
uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
uiListLayout.Parent = scrollFrame

-- Function to clear tab content inside scrollFrame
local function clearContent()
    for _, child in ipairs(scrollFrame:GetChildren()) do
        if not child:IsA("UIListLayout") and not child:IsA("UIPadding") then
            child:Destroy()
        end
    end
end

-- Player Tab Content (example toggles and sliders)
local function setupPlayerTab()
    clearContent()

    -- Example invisibility toggle
    local invisToggle = Instance.new("TextButton")
    invisToggle.Size = UDim2.new(0, 300, 0, 40)
    invisToggle.Position = UDim2.new(0, 10, 0, 10)
    invisToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    invisToggle.Text = "Toggle Invisibility âœ…"
    invisToggle.TextColor3 = Color3.new(1, 1, 1)
    invisToggle.Font = Enum.Font.Gotham
    invisToggle.TextSize = 18
    invisToggle.Parent = scrollFrame

    -- Example speed slider label (you can add slider later)
    local speedLabel = Instance.new("TextLabel")
    speedLabel.Size = UDim2.new(0, 300, 0, 30)
    speedLabel.Position = UDim2.new(0, 10, 0, 60)
    speedLabel.BackgroundTransparency = 1
    speedLabel.Text = "Speed: 16 (default)"
    speedLabel.TextColor3 = Color3.new(1, 1, 1)
    speedLabel.Font = Enum.Font.Gotham
    speedLabel.TextSize = 18
    speedLabel.Parent = scrollFrame

    -- Add more toggles/sliders as needed...
end

-- Main Tab Content (username + avatar, no title, no hip height)
local function setupMainTab()
    clearContent()

    local bgColor = Color3.fromRGB(30, 30, 30)

    -- Username label
    local usernameLabel = Instance.new("TextLabel")
    usernameLabel.Size = UDim2.new(0, 200, 0, 30)
    usernameLabel.Position = UDim2.new(0, 10, 0, 10)
    usernameLabel.BackgroundTransparency = 1
    usernameLabel.TextColor3 = Color3.new(1, 1, 1)
    usernameLabel.Font = Enum.Font.GothamBold
    usernameLabel.TextSize = 20
    usernameLabel.Text = player.Name
    usernameLabel.Parent = scrollFrame

    -- Player avatar image
    local playerImage = Instance.new("ImageLabel")
    playerImage.Size = UDim2.new(0, 100, 0, 100)
    playerImage.Position = UDim2.new(0, 10, 0, 50)
    playerImage.BackgroundColor3 = bgColor
    playerImage.BorderSizePixel = 0
    playerImage.Parent = scrollFrame

    local thumbnail, ready = Players:GetUserThumbnailAsync(player.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
    playerImage.Image = thumbnail

    -- You can add more Main tab content below here...
end

-- Settings Tab Content (simple placeholder)
local function setupSettingsTab()
    clearContent()
    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(0, 300, 0, 40)
    lbl.Position = UDim2.new(0, 10, 0, 10)
    lbl.BackgroundTransparency = 1
    lbl.Text = "Settings coming soon..."
    lbl.TextColor3 = Color3.new(1, 1, 1)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 18
    lbl.Parent = scrollFrame
end

-- Tab button click handling
for name, button in pairs(tabButtons) do
    button.MouseButton1Click:Connect(function()
        for _, btn in pairs(tabButtons) do
            btn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        end
        button.BackgroundColor3 = Color3.fromRGB(100, 100, 100)

        if name == "Player" then
            setupPlayerTab()
        elseif name == "Main" then
            setupMainTab()
        elseif name == "Settings" then
            setupSettingsTab()
        end
    end)
end

-- Initialize to Player tab on load
tabButtons["Player"].MouseButton1Click:Fire()

-- LOCK CAMERA MOVEMENT WHILE GUI IS FOCUSED
local cameraLocked = false

local function onFocusGained()
    if not cameraLocked then
        cameraLocked = true
        -- Disable camera rotation/movement
        UserInputService.MouseBehavior = Enum.MouseBehavior.LockCenter
    end
end

local function onFocusLost()
    if cameraLocked then
        cameraLocked = false
        -- Re-enable default mouse behavior
        UserInputService.MouseBehavior = Enum.MouseBehavior.Default
    end
end

-- Detect when player is interacting with GUI by mouse or touch
gui.DescendantAdded:Connect(function(desc)
    if desc:IsA("GuiObject") then
        desc.Focused:Connect(onFocusGained)
        desc.FocusLost:Connect(onFocusLost)
    end
end)

-- Extra safeguard: unlock camera if GUI closes or disabled
gui.AncestryChanged:Connect(function()
    if not gui:IsDescendantOf(game) then
        UserInputService.MouseBehavior = Enum.MouseBehavior.Default
    end
end)
